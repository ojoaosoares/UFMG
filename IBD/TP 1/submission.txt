-- 2023002138
-- A2
SELECT NM_ESTADO, AVG(QTD_DOMICILIOS) FROM ESTADOS INNER JOIN CENSO_DEMOGRAFICO ON ESTADOS.CD_AREA = CENSO_DEMOGRAFICO.CD_AREA_ESTADO GROUP BY NM_ESTADO;
-- A0
SELECT NM_PAIS FROM CONTINENTES INNER JOIN PAISES ON CONTINENTES.ID = PAISES.ID_CONTINENTE WHERE CONTINENTES.NM_CONTINENTE = 'AmÃ©rica do Sul';
-- A3
SELECT NM_MUNICIPIO, MIN(QTD_HABITANTES) FROM MUNICIPIOS INNER JOIN CENSO_POPULACIONAL ON MUNICIPIOS.CD_MUNICIPIO_COMPL = CENSO_POPULACIONAL.CD_MUNICIPIO_COMPL GROUP BY NM_MUNICIPIO;
-- A4
SELECT NM_ESTADO, NM_MUNICIPIO FROM ESTADOS INNER JOIN COVID ON ESTADOS.SIGLA = COVID.SIGLA_ESTADO WHERE QTD_CASOS_NOVOS >= 5000 AND QTD_OBITOS_NOVOS >= 50;
-- A1
SELECT NM_MUNICIPIO FROM MUNICIPIOS LEFT JOIN DENGUE_MUNICIPIO ON MUNICIPIOS.CD_MUNICIPIO_COMPL = DENGUE_MUNICIPIO.CD_MUNICIPIO_COMPL GROUP BY NM_MUNICIPIO;
-- B0
SELECT COUNT(DISTINCT MUNICIPIOS.CD_MUNICIPIO_COMPL), COUNT(DISTINCT DENGUE_MUNICIPIO.CD_MUNICIPIO_COMPL), COUNT(DISTINCT COVID.CD_MUNICIPIO_COMPL) FROM MUNICIPIOS LEFT JOIN DENGUE_MUNICIPIO ON DENGUE_MUNICIPIO.CD_MUNICIPIO_COMPL = MUNICIPIOS.CD_MUNICIPIO_COMPL LEFT JOIN COVID ON COVID.CD_MUNICIPIO_COMPL = MUNICIPIOS.CD_MUNICIPIO_COMPL;
-- B2
SELECT SIGLA, NM_PAIS, NM_CONTINENTE FROM PAISES INNER JOIN CONTINENTES ON PAISES.ID_CONTINENTE = CONTINENTES.ID ORDER BY SIGLA;
-- B1
SELECT NM_MUNICIPIO, (IFNULL(QTD_JAN, 0) + IFNULL(QTD_FEV, 0) + IFNULL(QTD_MAR, 0) + IFNULL(QTD_ABR, 0)) AS SUM_TOTAL, ROUND(((IFNULL(QTD_JAN, 0) + IFNULL(QTD_FEV, 0) + IFNULL(QTD_MAR, 0) + IFNULL(QTD_ABR, 0)) / CAST (TOTAL AS FLOAT)) * 100, 2) AS PERCENT FROM MUNICIPIOS LEFT JOIN DENGUE_MUNICIPIO ON MUNICIPIOS.CD_MUNICIPIO_COMPL = DENGUE_MUNICIPIO.CD_MUNICIPIO_COMPL INNER JOIN (SELECT SUM((IFNULL(QTD_JAN, 0) + IFNULL(QTD_FEV, 0) + IFNULL(QTD_MAR, 0) + IFNULL(QTD_ABR, 0))) AS TOTAL FROM MUNICIPIOS LEFT JOIN DENGUE_MUNICIPIO ON MUNICIPIOS.CD_MUNICIPIO_COMPL = DENGUE_MUNICIPIO.CD_MUNICIPIO_COMPL) ORDER BY SUM_TOTAL DESC LIMIT 10;
-- B3
SELECT NM_MUNICIPIO, IFNULL(MASCULINO, 0) AS H, IFNULL(FEMININO, 0) AS F FROM MUNICIPIOS INNER JOIN DENGUE_GENERO ON MUNICIPIOS.CD_MUNICIPIO_COMPL = DENGUE_GENERO.CD_MUNICIPIO_COMPL ORDER BY (H + F) DESC LIMIT 7;
-- B8
SELECT NM_ESTADO, COUNT(*) FROM ESTADOS INNER JOIN MUNICIPIOS ON ESTADOS.CD_AREA = MUNICIPIOS.CD_AREA_ESTADO GROUP BY ESTADOS.ID;